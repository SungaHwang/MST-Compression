2024-05-24 23:29:02,751:INFO:Logging setup complete - logging to: ResNet18/log/final/both\2024-05-24-23-29-02.log
2024-05-24 23:29:02,751:INFO:Starting the program
2024-05-24 23:29:02,751:INFO:Arguments: Namespace(dataset='MNIST', algorithm='kruskal', pruning_order='weight_first', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'], epochs=100)
2024-05-24 23:29:02,810:INFO:Dataset: MNIST
2024-05-24 23:29:08,104:INFO:Pruning layer: conv1.weight
2024-05-24 23:29:08,104:INFO:Pruning layer: conv1.weight at 0%
2024-05-24 23:29:08,275:INFO:conv1.weight: Pruned 0 / 9408 weights (0%)
2024-05-24 23:29:08,275:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-24 23:29:08,275:INFO:Pruning layer: layer1.0.conv1.weight at 0%
2024-05-24 23:29:08,777:INFO:layer1.0.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 23:29:08,778:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-24 23:29:08,778:INFO:Pruning layer: layer1.0.conv2.weight at 0%
2024-05-24 23:29:09,278:INFO:layer1.0.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 23:29:09,278:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-24 23:29:09,278:INFO:Pruning layer: layer1.1.conv1.weight at 0%
2024-05-24 23:29:09,859:INFO:layer1.1.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 23:29:09,859:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-24 23:29:09,860:INFO:Pruning layer: layer1.1.conv2.weight at 0%
2024-05-24 23:29:10,359:INFO:layer1.1.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 23:29:10,359:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-24 23:29:10,359:INFO:Pruning layer: layer2.0.conv1.weight at 0%
2024-05-24 23:29:11,443:INFO:layer2.0.conv1.weight: Pruned 0 / 73728 weights (0%)
2024-05-24 23:29:11,443:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-24 23:29:11,443:INFO:Pruning layer: layer2.0.conv2.weight at 0%
2024-05-24 23:29:13,681:INFO:layer2.0.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-24 23:29:13,681:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-24 23:29:13,681:INFO:Pruning layer: layer2.1.conv1.weight at 0%
2024-05-24 23:29:15,888:INFO:layer2.1.conv1.weight: Pruned 0 / 147456 weights (0%)
2024-05-24 23:29:15,889:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-24 23:29:15,889:INFO:Pruning layer: layer2.1.conv2.weight at 5%
2024-05-24 23:29:18,155:INFO:layer2.1.conv2.weight: Pruned 7296 / 147456 weights (5%)
2024-05-24 23:29:18,155:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-24 23:29:18,155:INFO:Pruning layer: layer3.0.conv1.weight at 5%
2024-05-24 23:29:22,528:INFO:layer3.0.conv1.weight: Pruned 14592 / 294912 weights (5%)
2024-05-24 23:29:22,528:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-24 23:29:22,528:INFO:Pruning layer: layer3.0.conv2.weight at 5%
2024-05-24 23:29:31,520:INFO:layer3.0.conv2.weight: Pruned 29440 / 589824 weights (5%)
2024-05-24 23:29:31,521:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-24 23:29:31,521:INFO:Pruning layer: layer3.1.conv1.weight at 40%
2024-05-24 23:29:40,607:INFO:layer3.1.conv1.weight: Pruned 235776 / 589824 weights (40%)
2024-05-24 23:29:40,607:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-24 23:29:40,608:INFO:Pruning layer: layer3.1.conv2.weight at 30%
2024-05-24 23:29:49,685:INFO:layer3.1.conv2.weight: Pruned 176896 / 589824 weights (30%)
2024-05-24 23:29:49,685:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-24 23:29:49,685:INFO:Pruning layer: layer4.0.conv1.weight at 30%
2024-05-24 23:30:08,364:INFO:layer4.0.conv1.weight: Pruned 353792 / 1179648 weights (30%)
2024-05-24 23:30:08,365:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-24 23:30:08,365:INFO:Pruning layer: layer4.0.conv2.weight at 40%
2024-05-24 23:30:47,296:INFO:layer4.0.conv2.weight: Pruned 943616 / 2359296 weights (40%)
2024-05-24 23:30:47,298:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-24 23:30:47,298:INFO:Pruning layer: layer4.1.conv1.weight at 70%
2024-05-24 23:31:26,547:INFO:layer4.1.conv1.weight: Pruned 1568095 / 2359296 weights (70%)
2024-05-24 23:31:26,548:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-24 23:31:26,548:INFO:Pruning layer: layer4.1.conv2.weight at 70%
2024-05-24 23:32:06,506:INFO:layer4.1.conv2.weight: Pruned 1567768 / 2359296 weights (70%)
2024-05-24 23:32:06,507:INFO:Total pruned weights: 4897271
2024-05-24 23:32:09,102:INFO:Pruning layer: conv1.weight
2024-05-24 23:34:48,735:INFO:conv1.weight: Pruned 0 filters at 0%.
2024-05-24 23:34:48,736:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-24 23:37:17,753:INFO:layer1.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 23:37:17,753:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-24 23:39:46,943:INFO:layer1.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-24 23:39:46,943:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-24 23:42:16,973:INFO:layer1.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 23:42:16,973:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-24 23:44:47,649:INFO:layer1.1.conv2.weight: Pruned 0 filters at 0%.
2024-05-24 23:44:47,649:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-24 23:49:42,593:INFO:layer2.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 23:49:42,594:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-24 23:54:36,239:INFO:layer2.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-24 23:54:36,239:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-24 23:59:31,400:INFO:layer2.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 23:59:31,400:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-25 00:04:26,557:INFO:layer2.1.conv2.weight: Pruned 6 filters at 5%.
2024-05-25 00:04:26,557:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-25 00:14:10,927:INFO:layer3.0.conv1.weight: Pruned 12 filters at 5%.
2024-05-25 00:14:10,927:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-25 00:23:59,029:INFO:layer3.0.conv2.weight: Pruned 12 filters at 5%.
2024-05-25 00:23:59,029:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-25 00:33:50,864:INFO:layer3.1.conv1.weight: Pruned 102 filters at 40%.
2024-05-25 00:33:50,864:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-25 00:43:39,697:INFO:layer3.1.conv2.weight: Pruned 38 filters at 30%.
2024-05-25 00:43:39,697:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-25 01:03:16,634:INFO:layer4.0.conv1.weight: Pruned 153 filters at 30%.
2024-05-25 01:03:16,634:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-25 01:22:51,660:INFO:layer4.0.conv2.weight: Pruned 204 filters at 40%.
2024-05-25 01:22:51,661:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-25 01:42:30,446:INFO:layer4.1.conv1.weight: Pruned 358 filters at 70%.
2024-05-25 01:42:30,446:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-25 02:02:11,485:INFO:layer4.1.conv2.weight: Pruned 358 filters at 70%.
2024-05-25 02:02:11,485:INFO:Total pruned filters in the model: 1243
2024-05-25 02:07:38,658:INFO:Epochs: 100
2024-05-25 02:07:38,658:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-25 02:07:38,658:INFO:original: Accuracy: 99.33, Inference Time: 3.965419292449951, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-25 02:07:38,658:INFO:pruned_wf: Accuracy: 99.14, Inference Time: 2.555202007293701, FLOPs: 2145779073536.0, Non-zero Params: 6792241
2024-05-25 02:07:38,659:INFO:pruned_wf_ft: Accuracy: 98.72, Inference Time: 2.2724812030792236, FLOPs: 1628580482816.0, Non-zero Params: 4626587
2024-05-25 02:07:38,659:INFO:pruned_wf_fine_tuned: Accuracy: 99.46, Inference Time: 2.3547379970550537, FLOPs: 1628580482816.0, Non-zero Params: 4626587
