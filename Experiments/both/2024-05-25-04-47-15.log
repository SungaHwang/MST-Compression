2024-05-25 04:47:15,844:INFO:Logging setup complete - logging to: ResNet18/log/final/both\2024-05-25-04-47-15.log
2024-05-25 04:47:15,844:INFO:Starting the program
2024-05-25 04:47:15,844:INFO:Arguments: Namespace(dataset='MNIST', algorithm='prim', pruning_order='weight_first', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'], epochs=100)
2024-05-25 04:47:15,875:INFO:Dataset: MNIST
2024-05-25 04:47:21,534:INFO:Pruning layer: conv1.weight
2024-05-25 04:47:21,534:INFO:Pruning layer: conv1.weight at 0%
2024-05-25 04:47:21,710:INFO:conv1.weight: Pruned 0 / 9408 weights (0%)
2024-05-25 04:47:21,710:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-25 04:47:21,710:INFO:Pruning layer: layer1.0.conv1.weight at 0%
2024-05-25 04:47:22,212:INFO:layer1.0.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 04:47:22,212:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-25 04:47:22,212:INFO:Pruning layer: layer1.0.conv2.weight at 0%
2024-05-25 04:47:22,717:INFO:layer1.0.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 04:47:22,717:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-25 04:47:22,717:INFO:Pruning layer: layer1.1.conv1.weight at 0%
2024-05-25 04:47:23,223:INFO:layer1.1.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 04:47:23,223:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-25 04:47:23,224:INFO:Pruning layer: layer1.1.conv2.weight at 0%
2024-05-25 04:47:23,722:INFO:layer1.1.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 04:47:23,722:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-25 04:47:23,722:INFO:Pruning layer: layer2.0.conv1.weight at 0%
2024-05-25 04:47:24,791:INFO:layer2.0.conv1.weight: Pruned 0 / 73728 weights (0%)
2024-05-25 04:47:24,792:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-25 04:47:24,792:INFO:Pruning layer: layer2.0.conv2.weight at 0%
2024-05-25 04:47:26,923:INFO:layer2.0.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-25 04:47:26,924:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-25 04:47:26,924:INFO:Pruning layer: layer2.1.conv1.weight at 0%
2024-05-25 04:47:29,015:INFO:layer2.1.conv1.weight: Pruned 0 / 147456 weights (0%)
2024-05-25 04:47:29,016:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-25 04:47:29,016:INFO:Pruning layer: layer2.1.conv2.weight at 5%
2024-05-25 04:47:31,099:INFO:layer2.1.conv2.weight: Pruned 7296 / 147456 weights (5%)
2024-05-25 04:47:31,099:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-25 04:47:31,099:INFO:Pruning layer: layer3.0.conv1.weight at 5%
2024-05-25 04:47:35,303:INFO:layer3.0.conv1.weight: Pruned 14592 / 294912 weights (5%)
2024-05-25 04:47:35,303:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-25 04:47:35,303:INFO:Pruning layer: layer3.0.conv2.weight at 5%
2024-05-25 04:47:43,906:INFO:layer3.0.conv2.weight: Pruned 29440 / 589824 weights (5%)
2024-05-25 04:47:43,906:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-25 04:47:43,906:INFO:Pruning layer: layer3.1.conv1.weight at 40%
2024-05-25 04:47:52,657:INFO:layer3.1.conv1.weight: Pruned 235776 / 589824 weights (40%)
2024-05-25 04:47:52,658:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-25 04:47:52,658:INFO:Pruning layer: layer3.1.conv2.weight at 30%
2024-05-25 04:48:01,359:INFO:layer3.1.conv2.weight: Pruned 176896 / 589824 weights (30%)
2024-05-25 04:48:01,359:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-25 04:48:01,359:INFO:Pruning layer: layer4.0.conv1.weight at 30%
2024-05-25 04:48:18,863:INFO:layer4.0.conv1.weight: Pruned 353792 / 1179648 weights (30%)
2024-05-25 04:48:18,864:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-25 04:48:18,864:INFO:Pruning layer: layer4.0.conv2.weight at 40%
2024-05-25 04:48:55,230:INFO:layer4.0.conv2.weight: Pruned 943616 / 2359296 weights (40%)
2024-05-25 04:48:55,232:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-25 04:48:55,232:INFO:Pruning layer: layer4.1.conv1.weight at 70%
2024-05-25 04:49:31,735:INFO:layer4.1.conv1.weight: Pruned 1568095 / 2359296 weights (70%)
2024-05-25 04:49:31,736:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-25 04:49:31,736:INFO:Pruning layer: layer4.1.conv2.weight at 70%
2024-05-25 04:50:08,417:INFO:layer4.1.conv2.weight: Pruned 1567768 / 2359296 weights (70%)
2024-05-25 04:50:08,418:INFO:Total pruned weights: 4897271
2024-05-25 04:50:10,976:INFO:Pruning layer: conv1.weight
2024-05-25 04:52:51,367:INFO:conv1.weight: Pruned 0 filters at 0%.
2024-05-25 04:52:51,367:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-25 04:55:20,579:INFO:layer1.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 04:55:20,579:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-25 04:57:49,939:INFO:layer1.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 04:57:49,939:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-25 05:00:18,712:INFO:layer1.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 05:00:18,712:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-25 05:02:46,357:INFO:layer1.1.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 05:02:46,357:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-25 05:07:42,201:INFO:layer2.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 05:07:42,201:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-25 05:12:38,084:INFO:layer2.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 05:12:38,085:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-25 05:17:32,596:INFO:layer2.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 05:17:32,596:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-25 05:22:28,818:INFO:layer2.1.conv2.weight: Pruned 6 filters at 5%.
2024-05-25 05:22:28,818:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-25 05:32:18,388:INFO:layer3.0.conv1.weight: Pruned 12 filters at 5%.
2024-05-25 05:32:18,388:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-25 05:42:09,294:INFO:layer3.0.conv2.weight: Pruned 12 filters at 5%.
2024-05-25 05:42:09,294:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-25 05:51:57,106:INFO:layer3.1.conv1.weight: Pruned 102 filters at 40%.
2024-05-25 05:51:57,106:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-25 06:01:47,313:INFO:layer3.1.conv2.weight: Pruned 38 filters at 30%.
2024-05-25 06:01:47,313:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-25 06:21:22,628:INFO:layer4.0.conv1.weight: Pruned 153 filters at 30%.
2024-05-25 06:21:22,629:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-25 06:41:03,537:INFO:layer4.0.conv2.weight: Pruned 204 filters at 40%.
2024-05-25 06:41:03,537:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-25 07:00:43,945:INFO:layer4.1.conv1.weight: Pruned 358 filters at 70%.
2024-05-25 07:00:43,945:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-25 07:20:20,328:INFO:layer4.1.conv2.weight: Pruned 358 filters at 70%.
2024-05-25 07:20:20,328:INFO:Total pruned filters in the model: 1243
2024-05-25 07:25:46,547:INFO:Epochs: 100
2024-05-25 07:25:46,547:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-25 07:25:46,547:INFO:original: Accuracy: 99.33, Inference Time: 4.252658843994141, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-25 07:25:46,547:INFO:pruned_wf: Accuracy: 99.14, Inference Time: 2.526367425918579, FLOPs: 2145779073536.0, Non-zero Params: 6792241
2024-05-25 07:25:46,548:INFO:pruned_wf_ft: Accuracy: 98.72, Inference Time: 2.26596999168396, FLOPs: 1628580482816.0, Non-zero Params: 4626587
2024-05-25 07:25:46,548:INFO:pruned_wf_fine_tuned: Accuracy: 99.46, Inference Time: 2.328808546066284, FLOPs: 1628580482816.0, Non-zero Params: 4626587
