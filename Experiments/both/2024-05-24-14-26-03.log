2024-05-24 14:26:03,237:INFO:Logging setup complete - logging to: ResNet18/log/final/both\2024-05-24-14-26-03.log
2024-05-24 14:26:03,237:INFO:Starting the program
2024-05-24 14:26:03,237:INFO:Arguments: Namespace(dataset='CIFAR10', algorithm='kruskal', pruning_order='weight_first', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'], epochs=100)
2024-05-24 14:26:04,457:INFO:Dataset: CIFAR10
2024-05-24 14:26:09,067:INFO:Pruning layer: conv1.weight
2024-05-24 14:26:09,067:INFO:Pruning layer: conv1.weight at 0%
2024-05-24 14:26:09,239:INFO:conv1.weight: Pruned 0 / 9408 weights (0%)
2024-05-24 14:26:09,240:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-24 14:26:09,240:INFO:Pruning layer: layer1.0.conv1.weight at 0%
2024-05-24 14:26:09,738:INFO:layer1.0.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 14:26:09,739:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-24 14:26:09,739:INFO:Pruning layer: layer1.0.conv2.weight at 0%
2024-05-24 14:26:10,247:INFO:layer1.0.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 14:26:10,247:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-24 14:26:10,247:INFO:Pruning layer: layer1.1.conv1.weight at 0%
2024-05-24 14:26:10,801:INFO:layer1.1.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 14:26:10,801:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-24 14:26:10,801:INFO:Pruning layer: layer1.1.conv2.weight at 0%
2024-05-24 14:26:11,297:INFO:layer1.1.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-24 14:26:11,297:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-24 14:26:11,297:INFO:Pruning layer: layer2.0.conv1.weight at 0%
2024-05-24 14:26:12,352:INFO:layer2.0.conv1.weight: Pruned 0 / 73728 weights (0%)
2024-05-24 14:26:12,352:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-24 14:26:12,352:INFO:Pruning layer: layer2.0.conv2.weight at 0%
2024-05-24 14:26:14,574:INFO:layer2.0.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-24 14:26:14,574:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-24 14:26:14,574:INFO:Pruning layer: layer2.1.conv1.weight at 0%
2024-05-24 14:26:16,715:INFO:layer2.1.conv1.weight: Pruned 0 / 147456 weights (0%)
2024-05-24 14:26:16,715:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-24 14:26:16,715:INFO:Pruning layer: layer2.1.conv2.weight at 5%
2024-05-24 14:26:18,937:INFO:layer2.1.conv2.weight: Pruned 7296 / 147456 weights (5%)
2024-05-24 14:26:18,937:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-24 14:26:18,937:INFO:Pruning layer: layer3.0.conv1.weight at 5%
2024-05-24 14:26:23,249:INFO:layer3.0.conv1.weight: Pruned 14592 / 294912 weights (5%)
2024-05-24 14:26:23,250:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-24 14:26:23,250:INFO:Pruning layer: layer3.0.conv2.weight at 5%
2024-05-24 14:26:32,469:INFO:layer3.0.conv2.weight: Pruned 29440 / 589824 weights (5%)
2024-05-24 14:26:32,470:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-24 14:26:32,470:INFO:Pruning layer: layer3.1.conv1.weight at 40%
2024-05-24 14:26:42,058:INFO:layer3.1.conv1.weight: Pruned 235776 / 589824 weights (40%)
2024-05-24 14:26:42,059:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-24 14:26:42,059:INFO:Pruning layer: layer3.1.conv2.weight at 30%
2024-05-24 14:26:51,477:INFO:layer3.1.conv2.weight: Pruned 176896 / 589824 weights (30%)
2024-05-24 14:26:51,478:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-24 14:26:51,478:INFO:Pruning layer: layer4.0.conv1.weight at 30%
2024-05-24 14:27:10,417:INFO:layer4.0.conv1.weight: Pruned 353792 / 1179648 weights (30%)
2024-05-24 14:27:10,418:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-24 14:27:10,418:INFO:Pruning layer: layer4.0.conv2.weight at 40%
2024-05-24 14:27:49,262:INFO:layer4.0.conv2.weight: Pruned 943616 / 2359296 weights (40%)
2024-05-24 14:27:49,264:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-24 14:27:49,264:INFO:Pruning layer: layer4.1.conv1.weight at 70%
2024-05-24 14:28:28,887:INFO:layer4.1.conv1.weight: Pruned 1571544 / 2359296 weights (70%)
2024-05-24 14:28:28,888:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-24 14:28:28,888:INFO:Pruning layer: layer4.1.conv2.weight at 70%
2024-05-24 14:29:06,364:INFO:layer4.1.conv2.weight: Pruned 1571284 / 2359296 weights (70%)
2024-05-24 14:29:06,365:INFO:Total pruned weights: 4904236
2024-05-24 14:29:08,256:INFO:Pruning layer: conv1.weight
2024-05-24 14:31:14,182:INFO:conv1.weight: Pruned 0 filters at 0%.
2024-05-24 14:31:14,182:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-24 14:33:26,796:INFO:layer1.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 14:33:26,796:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-24 14:35:33,483:INFO:layer1.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-24 14:35:33,483:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-24 14:37:44,125:INFO:layer1.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 14:37:44,125:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-24 14:39:51,463:INFO:layer1.1.conv2.weight: Pruned 0 filters at 0%.
2024-05-24 14:39:51,464:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-24 14:44:09,638:INFO:layer2.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 14:44:09,638:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-24 14:48:26,665:INFO:layer2.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-24 14:48:26,666:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-24 14:52:39,650:INFO:layer2.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-24 14:52:39,650:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-24 14:56:57,568:INFO:layer2.1.conv2.weight: Pruned 6 filters at 5%.
2024-05-24 14:56:57,568:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-24 15:05:28,202:INFO:layer3.0.conv1.weight: Pruned 12 filters at 5%.
2024-05-24 15:05:28,202:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-24 15:13:47,854:INFO:layer3.0.conv2.weight: Pruned 12 filters at 5%.
2024-05-24 15:13:47,854:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-24 15:22:12,482:INFO:layer3.1.conv1.weight: Pruned 102 filters at 40%.
2024-05-24 15:22:12,483:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-24 15:30:31,706:INFO:layer3.1.conv2.weight: Pruned 76 filters at 30%.
2024-05-24 15:30:31,706:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-24 15:47:12,457:INFO:layer4.0.conv1.weight: Pruned 153 filters at 30%.
2024-05-24 15:47:12,457:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-24 16:03:51,216:INFO:layer4.0.conv2.weight: Pruned 204 filters at 40%.
2024-05-24 16:03:51,216:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-24 16:20:27,545:INFO:layer4.1.conv1.weight: Pruned 97 filters at 70%.
2024-05-24 16:20:27,545:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-24 16:37:09,913:INFO:layer4.1.conv2.weight: Pruned 257 filters at 70%.
2024-05-24 16:37:09,913:INFO:Total pruned filters in the model: 919
2024-05-24 16:41:38,289:INFO:Epochs: 100
2024-05-24 16:41:38,289:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-24 16:41:38,290:INFO:original: Accuracy: 76.08, Inference Time: 3.3729827404022217, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-24 16:41:38,290:INFO:pruned_wf: Accuracy: 73.41, Inference Time: 1.8699877262115479, FLOPs: 2144206432256.0, Non-zero Params: 6785276
2024-05-24 16:41:38,290:INFO:pruned_wf_ft: Accuracy: 68.16, Inference Time: 1.9647126197814941, FLOPs: 1726246135040.0, Non-zero Params: 5120428
2024-05-24 16:41:38,291:INFO:pruned_wf_fine_tuned: Accuracy: 76.07, Inference Time: 1.9538908004760742, FLOPs: 1726246135040.0, Non-zero Params: 5120428
