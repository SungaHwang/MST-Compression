2024-05-25 07:25:49,299:INFO:Logging setup complete - logging to: ResNet18/log/final/both\2024-05-25-07-25-49.log
2024-05-25 07:25:49,299:INFO:Starting the program
2024-05-25 07:25:49,300:INFO:Arguments: Namespace(dataset='MNIST', algorithm='prim', pruning_order='filter_first', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'], epochs=100)
2024-05-25 07:25:49,331:INFO:Dataset: MNIST
2024-05-25 07:25:54,990:INFO:Pruning layer: conv1.weight
2024-05-25 07:28:40,323:INFO:conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:28:40,323:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-25 07:31:24,865:INFO:layer1.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:31:24,865:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-25 07:33:55,551:INFO:layer1.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 07:33:55,551:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-25 07:36:24,075:INFO:layer1.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:36:24,075:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-25 07:38:52,604:INFO:layer1.1.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 07:38:52,604:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-25 07:43:50,082:INFO:layer2.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:43:50,082:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-25 07:48:47,542:INFO:layer2.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 07:48:47,542:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-25 07:53:40,675:INFO:layer2.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:53:40,675:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-25 07:58:36,447:INFO:layer2.1.conv2.weight: Pruned 6 filters at 5%.
2024-05-25 07:58:36,448:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-25 08:08:22,356:INFO:layer3.0.conv1.weight: Pruned 12 filters at 5%.
2024-05-25 08:08:22,356:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-25 08:18:11,899:INFO:layer3.0.conv2.weight: Pruned 12 filters at 5%.
2024-05-25 08:18:11,900:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-25 08:28:01,053:INFO:layer3.1.conv1.weight: Pruned 102 filters at 40%.
2024-05-25 08:28:01,053:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-25 08:37:52,426:INFO:layer3.1.conv2.weight: Pruned 76 filters at 30%.
2024-05-25 08:37:52,426:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-25 08:57:31,462:INFO:layer4.0.conv1.weight: Pruned 153 filters at 30%.
2024-05-25 08:57:31,462:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-25 09:17:08,384:INFO:layer4.0.conv2.weight: Pruned 204 filters at 40%.
2024-05-25 09:17:08,384:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-25 09:36:46,652:INFO:layer4.1.conv1.weight: Pruned 70 filters at 70%.
2024-05-25 09:36:46,652:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-25 09:56:26,494:INFO:layer4.1.conv2.weight: Pruned 133 filters at 70%.
2024-05-25 09:56:26,494:INFO:Total pruned filters in the model: 768
2024-05-25 09:56:28,973:INFO:Pruning layer: conv1.weight
2024-05-25 09:56:28,973:INFO:Pruning layer: conv1.weight at 0%
2024-05-25 09:56:29,147:INFO:conv1.weight: Pruned 0 / 9408 weights (0%)
2024-05-25 09:56:29,147:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-25 09:56:29,147:INFO:Pruning layer: layer1.0.conv1.weight at 0%
2024-05-25 09:56:29,635:INFO:layer1.0.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 09:56:29,636:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-25 09:56:29,636:INFO:Pruning layer: layer1.0.conv2.weight at 0%
2024-05-25 09:56:30,133:INFO:layer1.0.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 09:56:30,133:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-25 09:56:30,133:INFO:Pruning layer: layer1.1.conv1.weight at 0%
2024-05-25 09:56:30,630:INFO:layer1.1.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 09:56:30,630:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-25 09:56:30,630:INFO:Pruning layer: layer1.1.conv2.weight at 0%
2024-05-25 09:56:31,130:INFO:layer1.1.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 09:56:31,130:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-25 09:56:31,130:INFO:Pruning layer: layer2.0.conv1.weight at 0%
2024-05-25 09:56:32,134:INFO:layer2.0.conv1.weight: Pruned 0 / 73728 weights (0%)
2024-05-25 09:56:32,134:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-25 09:56:32,134:INFO:Pruning layer: layer2.0.conv2.weight at 0%
2024-05-25 09:56:34,210:INFO:layer2.0.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-25 09:56:34,211:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-25 09:56:34,211:INFO:Pruning layer: layer2.1.conv1.weight at 0%
2024-05-25 09:56:36,306:INFO:layer2.1.conv1.weight: Pruned 0 / 147456 weights (0%)
2024-05-25 09:56:36,306:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-25 09:56:36,306:INFO:Pruning layer: layer2.1.conv2.weight at 5%
2024-05-25 09:56:38,336:INFO:layer2.1.conv2.weight: Pruned 7296 / 147456 weights (5%)
2024-05-25 09:56:38,336:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-25 09:56:38,336:INFO:Pruning layer: layer3.0.conv1.weight at 5%
2024-05-25 09:56:42,439:INFO:layer3.0.conv1.weight: Pruned 14592 / 294912 weights (5%)
2024-05-25 09:56:42,440:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-25 09:56:42,440:INFO:Pruning layer: layer3.0.conv2.weight at 5%
2024-05-25 09:56:50,922:INFO:layer3.0.conv2.weight: Pruned 29440 / 589824 weights (5%)
2024-05-25 09:56:50,923:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-25 09:56:50,923:INFO:Pruning layer: layer3.1.conv1.weight at 40%
2024-05-25 09:56:59,574:INFO:layer3.1.conv1.weight: Pruned 235776 / 589824 weights (40%)
2024-05-25 09:56:59,574:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-25 09:56:59,574:INFO:Pruning layer: layer3.1.conv2.weight at 30%
2024-05-25 09:57:08,177:INFO:layer3.1.conv2.weight: Pruned 176896 / 589824 weights (30%)
2024-05-25 09:57:08,178:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-25 09:57:08,178:INFO:Pruning layer: layer4.0.conv1.weight at 30%
2024-05-25 09:57:25,598:INFO:layer4.0.conv1.weight: Pruned 353792 / 1179648 weights (30%)
2024-05-25 09:57:25,599:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-25 09:57:25,599:INFO:Pruning layer: layer4.0.conv2.weight at 40%
2024-05-25 09:58:01,717:INFO:layer4.0.conv2.weight: Pruned 943616 / 2359296 weights (40%)
2024-05-25 09:58:01,718:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-25 09:58:01,718:INFO:Pruning layer: layer4.1.conv1.weight at 70%
2024-05-25 09:58:37,743:INFO:layer4.1.conv1.weight: Pruned 1534032 / 2359296 weights (70%)
2024-05-25 09:58:37,744:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-25 09:58:37,744:INFO:Pruning layer: layer4.1.conv2.weight at 70%
2024-05-25 09:59:15,332:INFO:layer4.1.conv2.weight: Pruned 1503141 / 2359296 weights (70%)
2024-05-25 09:59:15,333:INFO:Total pruned weights: 4798581
2024-05-25 10:04:23,849:INFO:Epochs: 100
2024-05-25 10:04:23,849:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-25 10:04:23,850:INFO:original: Accuracy: 99.33, Inference Time: 4.264585256576538, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-25 10:04:23,850:INFO:pruned_fw: Accuracy: 94.86, Inference Time: 2.4405014514923096, FLOPs: 2646059859968.0, Non-zero Params: 9003048
2024-05-25 10:04:23,850:INFO:pruned_fw_ft: Accuracy: 96.66, Inference Time: 2.339812755584717, FLOPs: 1779969277184.0, Non-zero Params: 5358360
2024-05-25 10:04:23,850:INFO:pruned_fw_fine_tuned: Accuracy: 99.42, Inference Time: 2.304863452911377, FLOPs: 1779969277184.0, Non-zero Params: 5358360
