2024-05-25 07:31:15,780:INFO:Logging setup complete - logging to: ResNet18/log/final/both2\2024-05-25-07-31-15.log
2024-05-25 07:31:15,780:INFO:Starting the program
2024-05-25 07:31:15,780:INFO:Arguments: Namespace(dataset='MNIST', algorithm='prim', pruning_order='filter_first', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'], epochs=100)
2024-05-25 07:31:15,815:INFO:Dataset: MNIST
2024-05-25 07:31:21,094:INFO:Pruning layer: conv1.weight
2024-05-25 07:33:53,288:INFO:conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:33:53,288:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-25 07:36:21,649:INFO:layer1.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:36:21,649:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-25 07:38:49,984:INFO:layer1.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 07:38:49,984:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-25 07:41:21,404:INFO:layer1.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:41:21,404:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-25 07:43:52,274:INFO:layer1.1.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 07:43:52,274:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-25 07:48:49,588:INFO:layer2.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:48:49,588:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-25 07:53:42,229:INFO:layer2.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-25 07:53:42,230:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-25 07:58:38,576:INFO:layer2.1.conv1.weight: Pruned 0 filters at 0%.
2024-05-25 07:58:38,576:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-25 08:03:34,114:INFO:layer2.1.conv2.weight: Pruned 3 filters at 2.5%.
2024-05-25 08:03:34,115:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-25 08:13:19,154:INFO:layer3.0.conv1.weight: Pruned 6 filters at 2.5%.
2024-05-25 08:13:19,154:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-25 08:23:09,199:INFO:layer3.0.conv2.weight: Pruned 6 filters at 2.5%.
2024-05-25 08:23:09,199:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-25 08:32:59,981:INFO:layer3.1.conv1.weight: Pruned 51 filters at 20%.
2024-05-25 08:32:59,982:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-25 08:42:50,786:INFO:layer3.1.conv2.weight: Pruned 38 filters at 15%.
2024-05-25 08:42:50,786:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-25 09:02:31,501:INFO:layer4.0.conv1.weight: Pruned 76 filters at 15%.
2024-05-25 09:02:31,502:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-25 09:22:10,042:INFO:layer4.0.conv2.weight: Pruned 102 filters at 20%.
2024-05-25 09:22:10,042:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-25 09:41:51,248:INFO:layer4.1.conv1.weight: Pruned 179 filters at 35%.
2024-05-25 09:41:51,248:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-25 10:01:48,800:INFO:layer4.1.conv2.weight: Pruned 179 filters at 35%.
2024-05-25 10:01:48,801:INFO:Total pruned filters in the model: 640
2024-05-25 10:01:51,370:INFO:Pruning layer: conv1.weight
2024-05-25 10:01:51,370:INFO:Pruning layer: conv1.weight at 0%
2024-05-25 10:01:51,510:INFO:conv1.weight: Pruned 0 / 9408 weights (0%)
2024-05-25 10:01:51,511:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-25 10:01:51,511:INFO:Pruning layer: layer1.0.conv1.weight at 0%
2024-05-25 10:01:52,071:INFO:layer1.0.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 10:01:52,072:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-25 10:01:52,072:INFO:Pruning layer: layer1.0.conv2.weight at 0%
2024-05-25 10:01:52,565:INFO:layer1.0.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 10:01:52,565:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-25 10:01:52,565:INFO:Pruning layer: layer1.1.conv1.weight at 0%
2024-05-25 10:01:53,056:INFO:layer1.1.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 10:01:53,057:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-25 10:01:53,057:INFO:Pruning layer: layer1.1.conv2.weight at 0%
2024-05-25 10:01:53,553:INFO:layer1.1.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-25 10:01:53,553:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-25 10:01:53,553:INFO:Pruning layer: layer2.0.conv1.weight at 0%
2024-05-25 10:01:54,597:INFO:layer2.0.conv1.weight: Pruned 0 / 73728 weights (0%)
2024-05-25 10:01:54,597:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-25 10:01:54,597:INFO:Pruning layer: layer2.0.conv2.weight at 0%
2024-05-25 10:01:56,729:INFO:layer2.0.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-25 10:01:56,729:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-25 10:01:56,729:INFO:Pruning layer: layer2.1.conv1.weight at 0%
2024-05-25 10:01:58,862:INFO:layer2.1.conv1.weight: Pruned 0 / 147456 weights (0%)
2024-05-25 10:01:58,862:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-25 10:01:58,863:INFO:Pruning layer: layer2.1.conv2.weight at 2.5%
2024-05-25 10:02:00,933:INFO:layer2.1.conv2.weight: Pruned 3584 / 147456 weights (2.5%)
2024-05-25 10:02:00,933:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-25 10:02:00,933:INFO:Pruning layer: layer3.0.conv1.weight at 2.5%
2024-05-25 10:02:05,174:INFO:layer3.0.conv1.weight: Pruned 7168 / 294912 weights (2.5%)
2024-05-25 10:02:05,174:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-25 10:02:05,174:INFO:Pruning layer: layer3.0.conv2.weight at 2.5%
2024-05-25 10:02:13,861:INFO:layer3.0.conv2.weight: Pruned 14592 / 589824 weights (2.5%)
2024-05-25 10:02:13,862:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-25 10:02:13,862:INFO:Pruning layer: layer3.1.conv1.weight at 20%
2024-05-25 10:02:22,699:INFO:layer3.1.conv1.weight: Pruned 117760 / 589824 weights (20%)
2024-05-25 10:02:22,699:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-25 10:02:22,699:INFO:Pruning layer: layer3.1.conv2.weight at 15%
2024-05-25 10:02:31,682:INFO:layer3.1.conv2.weight: Pruned 88320 / 589824 weights (15%)
2024-05-25 10:02:31,683:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-25 10:02:31,683:INFO:Pruning layer: layer4.0.conv1.weight at 15%
2024-05-25 10:02:49,297:INFO:layer4.0.conv1.weight: Pruned 176640 / 1179648 weights (15%)
2024-05-25 10:02:49,298:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-25 10:02:49,298:INFO:Pruning layer: layer4.0.conv2.weight at 20%
2024-05-25 10:03:27,295:INFO:layer4.0.conv2.weight: Pruned 471552 / 2359296 weights (20%)
2024-05-25 10:03:27,296:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-25 10:03:27,297:INFO:Pruning layer: layer4.1.conv1.weight at 35%
2024-05-25 10:04:05,003:INFO:layer4.1.conv1.weight: Pruned 825344 / 2359296 weights (35%)
2024-05-25 10:04:05,005:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-25 10:04:05,005:INFO:Pruning layer: layer4.1.conv2.weight at 35%
2024-05-25 10:04:40,603:INFO:layer4.1.conv2.weight: Pruned 825344 / 2359296 weights (35%)
2024-05-25 10:04:40,605:INFO:Total pruned weights: 2530304
2024-05-25 10:09:19,777:INFO:Epochs: 100
2024-05-25 10:09:19,777:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-25 10:09:19,777:INFO:original: Accuracy: 99.33, Inference Time: 3.9205594062805176, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-25 10:09:19,777:INFO:pruned_fw: Accuracy: 99.25, Inference Time: 2.5242815017700195, FLOPs: 2714469416960.0, Non-zero Params: 9165480
2024-05-25 10:09:19,777:INFO:pruned_fw_ft: Accuracy: 99.07, Inference Time: 2.2120656967163086, FLOPs: 2282093090816.0, Non-zero Params: 7369598
2024-05-25 10:09:19,778:INFO:pruned_fw_fine_tuned: Accuracy: 99.48, Inference Time: 2.2310631275177, FLOPs: 2282093090816.0, Non-zero Params: 7369598
