2024-05-19 07:51:33,934:INFO:Logging setup complete - logging to: ResNet18/log/final/2024-05-19-07-51-33.log
2024-05-19 07:51:33,934:INFO:Starting the program
2024-05-19 07:51:33,934:INFO:Arguments: Namespace(algorithm='kruskal', dataset='MNIST', epochs=100, pruning_method='prune_model_filters_by_importance', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'])
2024-05-19 07:51:33,959:INFO:Dataset: MNIST
2024-05-19 07:51:37,545:INFO:Pruning layer: conv1.weight
2024-05-19 07:54:28,124:INFO:conv1.weight: Pruned 0 filters at 0%.
2024-05-19 07:54:28,125:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-19 07:57:18,584:INFO:layer1.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-19 07:57:18,585:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-19 08:00:08,792:INFO:layer1.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-19 08:00:08,792:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-19 08:03:04,727:INFO:layer1.1.conv1.weight: Pruned 3 filters at 5%.
2024-05-19 08:03:04,728:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-19 08:06:15,389:INFO:layer1.1.conv2.weight: Pruned 3 filters at 5%.
2024-05-19 08:06:15,390:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-19 08:12:35,026:INFO:layer2.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-19 08:12:35,027:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-19 12:33:30,570:INFO:layer2.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-19 12:33:30,572:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-19 12:39:06,243:INFO:layer2.1.conv1.weight: Pruned 12 filters at 10%.
2024-05-19 12:39:06,243:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-19 12:44:38,110:INFO:layer2.1.conv2.weight: Pruned 12 filters at 10%.
2024-05-19 12:44:38,111:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-19 12:55:45,525:INFO:layer3.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-19 12:55:45,525:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-19 13:06:57,302:INFO:layer3.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-19 13:06:57,302:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-19 13:18:07,481:INFO:layer3.1.conv1.weight: Pruned 102 filters at 40%.
2024-05-19 13:18:07,482:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-19 13:29:21,021:INFO:layer3.1.conv2.weight: Pruned 102 filters at 40%.
2024-05-19 13:29:21,022:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-19 13:51:45,261:INFO:layer4.0.conv1.weight: Pruned 0 filters at 0%.
2024-05-19 13:51:45,261:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-19 14:14:10,110:INFO:layer4.0.conv2.weight: Pruned 0 filters at 0%.
2024-05-19 14:14:10,110:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-19 14:36:30,365:INFO:layer4.1.conv1.weight: Pruned 409 filters at 80%.
2024-05-19 14:36:30,365:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-19 14:58:35,109:INFO:layer4.1.conv2.weight: Pruned 348 filters at 80%.
2024-05-19 14:58:35,110:INFO:Total pruned filters in the model: 991
2024-05-19 14:58:38,041:INFO:Epochs: 100
2024-05-19 14:58:38,041:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-19 14:58:38,041:INFO:Original Model: Accuracy: 99.33, Inference Time: 2.837228775024414, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-19 14:58:38,041:INFO:Pruned Model (prune_model_filters_by_importance): Accuracy: 99.02, Inference Time: 2.8436806201934814, FLOPs: 2285283983360.0, Non-zero Params: 7700136
2024-05-19 15:21:48,319:INFO:Fine-tuned Pruned Model (prune_model_filters_by_importance): Accuracy: 99.51, Inference Time: 2.5434138774871826, FLOPs: 2285283983360.0, Non-zero Params: 7700136
