2024-05-16 20:37:02,431:INFO:Logging setup complete - logging to: ResNet18/log/final/2024-05-16-20-37-02.log
2024-05-16 20:37:02,432:INFO:Starting the program
2024-05-16 20:37:02,432:INFO:Arguments: Namespace(algorithm='kruskal', dataset='MNIST', epochs=100, pruning_method='prune_model_weights', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'])
2024-05-16 20:37:02,459:INFO:Dataset: MNIST
2024-05-16 20:37:06,585:INFO:Pruning layer: conv1.weight
2024-05-16 20:37:06,585:INFO:Pruning layer: conv1.weight at 0%
2024-05-16 20:37:06,687:INFO:conv1.weight: Pruned 0 / 9408 weights (0%)
2024-05-16 20:37:06,688:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-16 20:37:06,688:INFO:Pruning layer: layer1.0.conv1.weight at 0%
2024-05-16 20:37:07,072:INFO:layer1.0.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-16 20:37:07,073:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-16 20:37:07,073:INFO:Pruning layer: layer1.0.conv2.weight at 0%
2024-05-16 20:37:07,497:INFO:layer1.0.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-16 20:37:07,497:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-16 20:37:07,497:INFO:Pruning layer: layer1.1.conv1.weight at 0%
2024-05-16 20:37:07,901:INFO:layer1.1.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-16 20:37:07,901:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-16 20:37:07,901:INFO:Pruning layer: layer1.1.conv2.weight at 0%
2024-05-16 20:37:08,374:INFO:layer1.1.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-16 20:37:08,375:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-16 20:37:08,375:INFO:Pruning layer: layer2.0.conv1.weight at 0%
2024-05-16 20:37:09,183:INFO:layer2.0.conv1.weight: Pruned 0 / 73728 weights (0%)
2024-05-16 20:37:09,184:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-16 20:37:09,184:INFO:Pruning layer: layer2.0.conv2.weight at 0%
2024-05-16 20:37:11,124:INFO:layer2.0.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-16 20:37:11,125:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-16 20:37:11,125:INFO:Pruning layer: layer2.1.conv1.weight at 0%
2024-05-16 20:37:12,930:INFO:layer2.1.conv1.weight: Pruned 0 / 147456 weights (0%)
2024-05-16 20:37:12,931:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-16 20:37:12,931:INFO:Pruning layer: layer2.1.conv2.weight at 5%
2024-05-16 20:37:14,666:INFO:layer2.1.conv2.weight: Pruned 7296 / 147456 weights (5%)
2024-05-16 20:37:14,667:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-16 20:37:14,667:INFO:Pruning layer: layer3.0.conv1.weight at 5%
2024-05-16 20:37:18,260:INFO:layer3.0.conv1.weight: Pruned 14592 / 294912 weights (5%)
2024-05-16 20:37:18,261:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-16 20:37:18,262:INFO:Pruning layer: layer3.0.conv2.weight at 5%
2024-05-16 20:37:26,054:INFO:layer3.0.conv2.weight: Pruned 29440 / 589824 weights (5%)
2024-05-16 20:37:26,055:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-16 20:37:26,055:INFO:Pruning layer: layer3.1.conv1.weight at 40%
2024-05-16 20:37:35,475:INFO:layer3.1.conv1.weight: Pruned 235776 / 589824 weights (40%)
2024-05-16 20:37:35,477:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-16 20:37:35,477:INFO:Pruning layer: layer3.1.conv2.weight at 30%
2024-05-16 20:37:44,434:INFO:layer3.1.conv2.weight: Pruned 176896 / 589824 weights (30%)
2024-05-16 20:37:44,437:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-16 20:37:44,437:INFO:Pruning layer: layer4.0.conv1.weight at 30%
2024-05-16 20:38:06,588:INFO:layer4.0.conv1.weight: Pruned 353792 / 1179648 weights (30%)
2024-05-16 20:38:06,600:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-16 20:38:06,600:INFO:Pruning layer: layer4.0.conv2.weight at 40%
2024-05-16 20:38:52,703:INFO:layer4.0.conv2.weight: Pruned 943616 / 2359296 weights (40%)
2024-05-16 20:38:52,705:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-16 20:38:52,706:INFO:Pruning layer: layer4.1.conv1.weight at 70%
2024-05-16 20:39:24,629:INFO:layer4.1.conv1.weight: Pruned 1568095 / 2359296 weights (70%)
2024-05-16 20:39:24,632:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-16 20:39:24,632:INFO:Pruning layer: layer4.1.conv2.weight at 70%
2024-05-16 20:39:55,373:INFO:layer4.1.conv2.weight: Pruned 1567768 / 2359296 weights (70%)
2024-05-16 20:39:55,384:INFO:Total pruned weights: 4897271
2024-05-16 20:39:58,658:INFO:Epochs: 100
2024-05-16 20:39:58,658:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-16 20:39:58,658:INFO:Original Model: Accuracy: 99.33, Inference Time: 3.276902198791504, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-16 20:39:58,658:INFO:Pruned Model (prune_model_weights): Accuracy: 99.14, Inference Time: 3.2146999835968018, FLOPs: 2145779073536.0, Non-zero Params: 6792241
2024-05-16 21:12:30,616:INFO:Fine-tuned Pruned Model (prune_model_weights): Accuracy: 99.42, Inference Time: 3.906564712524414, FLOPs: 2145779073536.0, Non-zero Params: 6792241
