2024-05-18 15:34:05,197:INFO:Logging setup complete - logging to: ResNet18/log/final/2024-05-18-15-34-05.log
2024-05-18 15:34:05,197:INFO:Starting the program
2024-05-18 15:34:05,197:INFO:Arguments: Namespace(algorithm='kruskal', dataset='MNIST', epochs=100, pruning_method='prune_model_weights', target_layers=['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight'])
2024-05-18 15:34:05,225:INFO:Dataset: MNIST
2024-05-18 15:34:09,847:INFO:Pruning layer: conv1.weight
2024-05-18 15:34:09,847:INFO:Pruning layer: conv1.weight at 0%
2024-05-18 15:34:09,949:INFO:conv1.weight: Pruned 0 / 9408 weights (0%)
2024-05-18 15:34:09,949:INFO:Pruning layer: layer1.0.conv1.weight
2024-05-18 15:34:09,949:INFO:Pruning layer: layer1.0.conv1.weight at 0%
2024-05-18 15:34:10,315:INFO:layer1.0.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-18 15:34:10,315:INFO:Pruning layer: layer1.0.conv2.weight
2024-05-18 15:34:10,315:INFO:Pruning layer: layer1.0.conv2.weight at 0%
2024-05-18 15:34:10,693:INFO:layer1.0.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-18 15:34:10,694:INFO:Pruning layer: layer1.1.conv1.weight
2024-05-18 15:34:10,694:INFO:Pruning layer: layer1.1.conv1.weight at 0%
2024-05-18 15:34:11,072:INFO:layer1.1.conv1.weight: Pruned 0 / 36864 weights (0%)
2024-05-18 15:34:11,072:INFO:Pruning layer: layer1.1.conv2.weight
2024-05-18 15:34:11,072:INFO:Pruning layer: layer1.1.conv2.weight at 0%
2024-05-18 15:34:11,524:INFO:layer1.1.conv2.weight: Pruned 0 / 36864 weights (0%)
2024-05-18 15:34:11,524:INFO:Pruning layer: layer2.0.conv1.weight
2024-05-18 15:34:11,524:INFO:Pruning layer: layer2.0.conv1.weight at 0%
2024-05-18 15:34:12,285:INFO:layer2.0.conv1.weight: Pruned 0 / 73728 weights (0%)
2024-05-18 15:34:12,286:INFO:Pruning layer: layer2.0.conv2.weight
2024-05-18 15:34:12,286:INFO:Pruning layer: layer2.0.conv2.weight at 0%
2024-05-18 15:34:13,943:INFO:layer2.0.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-18 15:34:13,944:INFO:Pruning layer: layer2.1.conv1.weight
2024-05-18 15:34:13,944:INFO:Pruning layer: layer2.1.conv1.weight at 0%
2024-05-18 15:34:15,605:INFO:layer2.1.conv1.weight: Pruned 0 / 147456 weights (0%)
2024-05-18 15:34:15,605:INFO:Pruning layer: layer2.1.conv2.weight
2024-05-18 15:34:15,605:INFO:Pruning layer: layer2.1.conv2.weight at 0%
2024-05-18 15:34:17,260:INFO:layer2.1.conv2.weight: Pruned 0 / 147456 weights (0%)
2024-05-18 15:34:17,261:INFO:Pruning layer: layer3.0.conv1.weight
2024-05-18 15:34:17,261:INFO:Pruning layer: layer3.0.conv1.weight at 5%
2024-05-18 15:34:20,601:INFO:layer3.0.conv1.weight: Pruned 14592 / 294912 weights (5%)
2024-05-18 15:34:20,603:INFO:Pruning layer: layer3.0.conv2.weight
2024-05-18 15:34:20,603:INFO:Pruning layer: layer3.0.conv2.weight at 5%
2024-05-18 15:34:27,712:INFO:layer3.0.conv2.weight: Pruned 29440 / 589824 weights (5%)
2024-05-18 15:34:27,713:INFO:Pruning layer: layer3.1.conv1.weight
2024-05-18 15:34:27,713:INFO:Pruning layer: layer3.1.conv1.weight at 30%
2024-05-18 15:34:34,792:INFO:layer3.1.conv1.weight: Pruned 176896 / 589824 weights (30%)
2024-05-18 15:34:34,793:INFO:Pruning layer: layer3.1.conv2.weight
2024-05-18 15:34:34,793:INFO:Pruning layer: layer3.1.conv2.weight at 40%
2024-05-18 15:34:41,992:INFO:layer3.1.conv2.weight: Pruned 235776 / 589824 weights (40%)
2024-05-18 15:34:41,993:INFO:Pruning layer: layer4.0.conv1.weight
2024-05-18 15:34:41,993:INFO:Pruning layer: layer4.0.conv1.weight at 40%
2024-05-18 15:34:56,349:INFO:layer4.0.conv1.weight: Pruned 471552 / 1179648 weights (40%)
2024-05-18 15:34:56,350:INFO:Pruning layer: layer4.0.conv2.weight
2024-05-18 15:34:56,351:INFO:Pruning layer: layer4.0.conv2.weight at 40%
2024-05-18 15:35:27,305:INFO:layer4.0.conv2.weight: Pruned 943616 / 2359296 weights (40%)
2024-05-18 15:35:27,308:INFO:Pruning layer: layer4.1.conv1.weight
2024-05-18 15:35:27,308:INFO:Pruning layer: layer4.1.conv1.weight at 70%
2024-05-18 15:35:58,704:INFO:layer4.1.conv1.weight: Pruned 1568095 / 2359296 weights (70%)
2024-05-18 15:35:58,705:INFO:Pruning layer: layer4.1.conv2.weight
2024-05-18 15:35:58,706:INFO:Pruning layer: layer4.1.conv2.weight at 70%
2024-05-18 15:36:30,208:INFO:layer4.1.conv2.weight: Pruned 1567768 / 2359296 weights (70%)
2024-05-18 15:36:30,210:INFO:Total pruned weights: 5007735
2024-05-18 15:36:33,735:INFO:Epochs: 100
2024-05-18 15:36:33,735:INFO:Target layers: ['conv1.weight', 'layer1.0.conv1.weight', 'layer1.0.conv2.weight', 'layer1.1.conv1.weight', 'layer1.1.conv2.weight', 'layer2.0.conv1.weight', 'layer2.0.conv2.weight', 'layer2.1.conv1.weight', 'layer2.1.conv2.weight', 'layer3.0.conv1.weight', 'layer3.0.conv2.weight', 'layer3.1.conv1.weight', 'layer3.1.conv2.weight', 'layer4.0.conv1.weight', 'layer4.0.conv2.weight', 'layer4.1.conv1.weight', 'layer4.1.conv2.weight']
2024-05-18 15:36:33,735:INFO:Original Model: Accuracy: 99.33, Inference Time: 3.7018191814422607, FLOPs: 3316369473536.0, Non-zero Params: 11689512
2024-05-18 15:36:33,735:INFO:Pruned Model (prune_model_weights): Accuracy: 99.06, Inference Time: 3.4349329471588135, FLOPs: 2139073954304.0, Non-zero Params: 6681777
2024-05-18 16:15:42,224:INFO:Fine-tuned Pruned Model (prune_model_weights): Accuracy: 99.48, Inference Time: 3.2865400314331055, FLOPs: 2139073954304.0, Non-zero Params: 6681777
